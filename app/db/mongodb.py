import osfrom dotenv import load_dotenvfrom motor.motor_asyncio import AsyncIOMotorClientfrom beanie import init_beaniefrom app.models.hotel import HotelSuite, Hotel, HotelProfilefrom app.models.booking import Booking# Global client reference for connection management_client: AsyncIOMotorClient = Noneload_dotenv(verbose=True)def sanitize_env_value(value: str) -> str:    """Remove quotes, carriage returns, and whitespace from environment variable values."""    if not value:        return ""    return value.strip().strip('"').strip("'").replace('\r', '').replace('\n', '').strip()async def init_db():    """    Initialize the MongoDB connection and Beanie ODM.    """    # Get and sanitize environment variable    environment = sanitize_env_value(os.getenv("ENVIRONMENT", "production"))    # Use environment variables for configuration with defaults    if environment == "production":        mongo_dsn = sanitize_env_value(os.getenv("MONGO_DSN", ""))        db_name = sanitize_env_value(os.getenv("MONGO_DB_NAME", ""))        # Fallback if MONGO_DSN is not set        if not mongo_dsn:            mongo_dsn = sanitize_env_value(os.getenv("DATABASE_URL", ""))        # Fallback if db_name is still empty or invalid        if not db_name:            db_name = "test_mobile"    else:        mongo_dsn = "mongodb://localhost:27017"        db_name = "sandbox"    print(f"=== Connecting to MongoDB {mongo_dsn[:4]}, using database '{db_name[:3]}' ===")    client = AsyncIOMotorClient(mongo_dsn)        # Initialize Beanie with the database and document models    await init_beanie(        database=client[db_name],        document_models=[            HotelSuite,            Hotel,            HotelProfile,            Booking,        ]    )async def connect_to_mongo():    """    Connect to MongoDB and initialize Beanie ODM.    Called during application startup.    """    await init_db()async def close_mongo_connection():    """    Close the MongoDB connection.    Called during application shutdown.    """    global _client    if _client:        _client.close()